<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<title>Canvas Trading Flame</title>

<style>
  html, body {
    margin: 0;
    padding: 0;
    background: transparent;
    overflow: hidden;
  }

  /* Notion-safe fixed height */
  #wrap {
    width: 100%;
    height: 90px;
  }

  canvas {
    width: 100%;
    height: 100%;
    display: block;
  }
</style>
</head>

<body>

<div id="wrap">
  <canvas id="flame"></canvas>
</div>

<script>
const canvas = document.getElementById("flame");
const ctx = canvas.getContext("2d");

/* ---------- SAFE RESIZE ---------- */
function resize() {
  const dpr = window.devicePixelRatio || 1;
  const rect = canvas.getBoundingClientRect();

  canvas.width  = rect.width * dpr;
  canvas.height = rect.height * dpr;

  ctx.setTransform(dpr, 0, 0, dpr, 0, 0);
}
resize();
window.addEventListener("resize", resize);

/* ---------- FLAMES ---------- */
const flames = [];
const flameDensity = 0.75;

function initFlames() {
  flames.length = 0;
  const count = Math.floor(canvas.clientWidth * flameDensity);

  for (let i = 0; i < count; i++) {
    flames.push({
      x: i / count,
      phase: Math.random() * Math.PI * 2,
      height: 0.42 + Math.random() * 0.22,
      sway: 0.6 + Math.random() * 0.8,
      speed: 0.7 + Math.random() * 0.4,
      offset: (Math.random() - 0.5) * 6
    });
  }
}
initFlames();

/* ---------- LOOP ---------- */
let t = 0;

function draw() {
  t += 0.016;
  ctx.clearRect(0, 0, canvas.width, canvas.height);

  const w = canvas.clientWidth;
  const h = canvas.clientHeight;
  const baseY = h * 0.95;

  /* base glow */
  const glow = ctx.createRadialGradient(
    w / 2, baseY,
    10,
    w / 2, baseY,
    h * 0.55
  );
  glow.addColorStop(0, "rgba(255,170,80,0.55)");
  glow.addColorStop(1, "rgba(255,120,40,0)");
  ctx.fillStyle = glow;
  ctx.fillRect(0, 0, w, h);

  /* flames */
  flames.forEach(f => {
    const x = f.x * w + f.offset;
    const flameH = h * f.height;
    const sway = Math.sin(t * f.speed + f.phase) * f.sway;

    const grad = ctx.createLinearGradient(0, baseY - flameH, 0, baseY);
    grad.addColorStop(0, "rgba(255,240,200,0)");
    grad.addColorStop(0.35, "rgba(255,200,120,0.85)");
    grad.addColorStop(0.65, "rgba(255,140,40,0.95)");
    grad.addColorStop(1, "rgba(255,90,20,1)");

    ctx.beginPath();
    ctx.moveTo(x, baseY);
    ctx.quadraticCurveTo(
      x + sway * 6,
      baseY - flameH * 0.55,
      x,
      baseY - flameH
    );
    ctx.quadraticCurveTo(
      x - sway * 6,
      baseY - flameH * 0.55,
      x,
      baseY
    );
    ctx.fillStyle = grad;
    ctx.fill();
  });

  /* haze above tips */
  ctx.fillStyle = "rgba(0,0,0,0.12)";
  ctx.fillRect(0, 0, w, h * 0.35);

  requestAnimationFrame(draw);
}

draw();
</script>

</body>
</html>